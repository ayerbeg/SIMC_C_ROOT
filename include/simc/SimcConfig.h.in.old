// include/simc/SimcConfig.h.in
// Configuration file for SIMC - automatically generated by CMake
// DO NOT EDIT THIS FILE MANUALLY - edit SimcConfig.h.in instead

#ifndef SIMC_CONFIG_H
#define SIMC_CONFIG_H

#include <string>

namespace simc {
namespace config {

// ============================================================================
// Version Information
// ============================================================================

constexpr int VERSION_MAJOR = @PROJECT_VERSION_MAJOR@;
constexpr int VERSION_MINOR = @PROJECT_VERSION_MINOR@;
constexpr int VERSION_PATCH = @PROJECT_VERSION_PATCH@;
constexpr const char* VERSION_STRING = "@PROJECT_VERSION@";

// ============================================================================
// Data Directory Paths
// ============================================================================

// Source data directory (development)
constexpr const char* SOURCE_DATA_DIR = "@SIMC_DATA_DIR@";

// Build data directory (development, after copy_data_files)
constexpr const char* BUILD_DATA_DIR = "@CMAKE_BINARY_DIR@/data";

// Install data directory (after 'make install')
constexpr const char* INSTALL_DATA_DIR = "@SIMC_INSTALL_DATADIR@";

// ============================================================================
// Data Path Resolution
// ============================================================================

/**
 * @brief Get the data directory path
 * 
 * This function returns the appropriate data directory based on the
 * runtime environment:
 * 1. If SIMC_DATA_DIR environment variable is set, use that
 * 2. If running from build directory, use BUILD_DATA_DIR
 * 3. If installed, use INSTALL_DATA_DIR
 * 4. Fall back to SOURCE_DATA_DIR
 * 
 * @return Path to data directory
 */
inline std::string GetDataDir() {
    // Check environment variable first
    const char* env_data_dir = std::getenv("SIMC_DATA_DIR");
    if (env_data_dir != nullptr && env_data_dir[0] != '\0') {
        return std::string(env_data_dir);
    }
    
    // Try build directory (for development)
    // Check if build data directory exists by trying to access it
    std::string build_dir = BUILD_DATA_DIR;
    
    // Try install directory
    std::string install_dir = INSTALL_DATA_DIR;
    
    // Fall back to source directory
    return std::string(SOURCE_DATA_DIR);
}

/**
 * @brief Get full path to a COSY matrix file
 * 
 * @param spectrometer Spectrometer name (hms, shms, sos, hrsl, hrsr)
 * @param type "forward" or "recon"
 * @return Full path to matrix file
 * 
 * Example:
 *   GetMatrixPath("hms", "forward") 
 *   → "/path/to/data/matrices/hms/forward_cosy.dat"
 */
inline std::string GetMatrixPath(const std::string& spectrometer, 
                                 const std::string& type) {
    std::string data_dir = GetDataDir();
    
    // Convert to lowercase
    std::string spec_lower = spectrometer;
    std::transform(spec_lower.begin(), spec_lower.end(), spec_lower.begin(),
                   [](unsigned char c){ return std::tolower(c); });
    
    std::string filename;
    if (spec_lower == "shms") {
        filename = "shms_" + type + ".dat";
    } else if (spec_lower == "hrsl" || spec_lower == "hrsr") {
        filename = "hrs_" + type + "_cosy.dat";
    } else {
        filename = type + "_cosy.dat";
    }
    
    return data_dir + "/matrices/" + spec_lower + "/" + filename;
}

/**
 * @brief Get full path to a configuration file
 * 
 * @param config_name Configuration file name (without .json)
 * @return Full path to config file
 * 
 * Example:
 *   GetConfigPath("default") → "/path/to/data/config/default.json"
 */
inline std::string GetConfigPath(const std::string& config_name) {
    std::string data_dir = GetDataDir();
    return data_dir + "/config/" + config_name + ".json";
}

/**
 * @brief Get full path to a physics table file
 * 
 * @param table_name Table file name
 * @return Full path to table file
 * 
 * Example:
 *   GetTablePath("maidpi0p.dat") → "/path/to/data/tables/maidpi0p.dat"
 */
inline std::string GetTablePath(const std::string& table_name) {
    std::string data_dir = GetDataDir();
    return data_dir + "/tables/" + table_name;
}

// ============================================================================
// Build Information
// ============================================================================

constexpr const char* BUILD_TYPE = "@CMAKE_BUILD_TYPE@";
constexpr const char* CXX_COMPILER = "@CMAKE_CXX_COMPILER@";
constexpr const char* CXX_FLAGS = "@CMAKE_CXX_FLAGS@";

} // namespace config
} // namespace simc

#endif // SIMC_CONFIG_H
